# Copyright 2025 Canonical Ltd.
# See LICENSE file for licensing details.
alert: WazuhFilebeatErrorFound
expr: count_over_time({%%juju_topology%%, filename="/var/log/filebeat/filebeat"} |~ "(?i)error" [5m]) > 5
for: 5m
labels:
  severity: error
annotations:
  summary: Filebeat errors detected.
  description: This alert is triggered when filebeat logs more than the specified number of error messages in the specified time frame.

